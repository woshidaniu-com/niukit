(function(A){A.bootui=A.bootui||{};A.bootui.widget=A.bootui.widget||{};A.bootui.widget.FileWrap=function(C,B){B.beforeRender.call(this,C);this.initialize.call(this,C,B);B.afterRender.call(this,C)};A.bootui.widget.FileWrap.prototype={constructor:A.bootui.widget.FileWrap,initialize:function(C,E){var I=this;this.$element=A(C);this.options=E;if(!A(C).is(":file")){throw new Error(" Current Element is not a file input ! ")}else{if(A.browser.msie===true&&A.browser.version<9){return}I.initializedFlag=true;var G=A(E.template);var H=A(G).find(".file-input");var B=E.placeholder||A(C).attr("placeholder")||A(C).attr("title")||"浏览...";A(H).append("<label>"+B+"</label>");A(G).css({"width":E.width||A(C).parent().innerWidth(),"height":E.height||A(C).parent().innerHeight()});var D=A(G).find("p.tips");if(E.message&&A.trim(E.message).length>0){A(D).append((A.isFunction(E.message)?E.message.call(this):E.message.toString()))}var J=A.fn.filewrap.messages;var F=A(C).clone(true,true);A(F).change(function(K){A(D).removeClass("error");var L=A(K.target).getFiles()||K.dataTransfer.files;A.filehandle(L,{fileType:E.fileType||"*.*",maxSize:E.maxSize,maxTotal:E.maxTotal,maxCount:E.maxCount,handleInvalidType:function(N,M){A(D).empty().append(M).addClass("error");A(F).clearFile()},handleOverMaxCount:function(M){A(D).empty().append(M).addClass("error");A(F).clearFile()},handleOverTotal:function(M){A(D).empty().append(M).addClass("error");A(F).clearFile()},handleOverSize:function(N,M){A(D).empty().append(M).addClass("error");A(F).clearFile()},handleFile:function(O,M,N){A(D).empty().append(M)}})});A(H).append(F);A(C).replaceWith(G)}},initialized:function(){return this.initializedFlag==true},setDefaults:function(B){A.extend(A.fn.filewrap.defaults,B)},getDefaults:function(){return A.fn.filewrap.defaults}};A.fn.filewrap=function(B){if(typeof B=="string"){var D=A(this[0]),F=D.data("filewrap");if(!F&&B=="destroy"){return}if(F){var E=A.grep(arguments||[],function(H,G){return G>=1});var C=F[B].apply(F,[].concat(E||[]));return(typeof C!="undefined")?C:D}}else{return this.each(function(){var G=A(this),I=G.data("filewrap");if(!I){var H=A.extend(true,{},A.fn.filewrap.defaults,G.data(),((typeof B=="object"&&B)?B:{}));G.data("filewrap",(I=new A.bootui.widget.FileWrap(this,H)))}})}};A.fn.filewrap.defaults={version:"1.0.0",beforeRender:A.noop,errorRender:A.noop,afterRender:A.noop,width:null,height:"80px",placeholder:"浏览...",message:null,fileType:"*.*",maxSize:"10M",maxTotal:"100MB",maxCount:30,template:'<div class="filewrap"><div class="placeholder"><div class="wrap"><div class="file-input"></div><p class="tips"></p></div></div></div>'};A.fn.filewrap.Constructor=A.bootui.widget.FileWrap;A(document).off("wrap.filewrap.widget.data-api",'[data-widget*="filewrap"]').on("wrap.filewrap.widget.data-api",'[data-widget*="filewrap"]',function(B){if(B.currentTarget=this){if(A(this).is(":file")){A(this).filewrap()}}})}(jQuery));