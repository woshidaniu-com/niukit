(function(a){a.bootui=a.bootui||{};a.bootui.widget=a.bootui.widget||{};a.bootui.widget.BootstrapTree=function(c,b){b.beforeRender.call(this,c);try{this.initialize.call(this,c,b)}catch(d){b.errorRender.call(this,d)}b.afterRender.call(this,c)};a.bootui.widget.BootstrapTree.prototype={constructor:a.bootui.widget.BootstrapTree,initialize:function(e,c){if(a(e).children().size()==0){if(a.trim(c.url).length>0){a.ajax({type:c.mtype||"POST",url:c.url,data:c.postData||{},cache:c.cache||false,async:false,success:function(f){c.data=f||[]}})}function b(j,h,g){var f=[];var i=parseInt(h||"0")>parseInt(c.visibleLevel||"0")?'  style="display: none;" ':" ";f.push('<li id="'+(g.id||"")+'" data-parent="'+(g.parent_id||"")+'" '+((g.disabled==true)?' class="disabled" ':"")+i);a.each(g.attributes||{},function(k,l){f.push(" "+k+'="'+l+'" ')});f.push(" >");if(g.selectable==true){f.push('<input type="checkbox" name="'+(j+"."+(g.name||g.id||"node_id"))+'"  '+((g.checked==true)?' checked="checked" ':"")+">")}f.push("<span >");if(g.selectable!=true&&a.founded(g.iconClass)){f.push('<i class="'+g.iconClass+'"></i>')}f.push(g.text);f.push("</span>");a.each(g.children||[],function(l,k){f.push(b(j+".children["+l+"]",(h+1),k))});f.push("</li>");return f.join("")}var d=[];if(!a(e).is("div")){d.push('<div class="tree well">')}d.push("<ul>");a.each(c.data||[],function(f,g){d.push(b("treeList["+f+"]",0,f,g))});d.push("</ul>");if(!a(e).is("div")){d.push("</div>")}a(e).empty().html(d.join(""))}if(c.collapsable==true){a(e).find(".tree li:has(ul)").addClass("parent_li").find(" > span:eq(0)").attr("title",c.collapseText);a(e).find(".tree li.parent_li > span").on("click",function(g){if(a(this).index()==0){var f=a(this).parent("li.parent_li").find(" > ul > li");if(f.is(":visible")){f.hide(c.collapseSpeed||"fast");a(this).attr("title",c.expandText).find(" > i").addClass(c.expandIconClass).removeClass(c.collapseIconClass)}else{f.show(c.collapseSpeed||"fast");a(this).attr("title",c.collapseText).find(" > i").addClass(c.collapseIconClass).removeClass(c.expandIconClass)}}g.stopPropagation()})}a.extend(true,this,{destroy:function(){a(e).off(".bootstrapTree").removeData("bootui.bootstrapTree")}})},setDefaults:function(b){a.extend(a.fn.bootstrapTree.defaults,b)},getDefaults:function(){return a.fn.bootstrapTree.defaults}};a.fn.bootstrapTree=function(c){var b=a.grep(arguments||[],function(e,d){return d>=1});return this.each(function(){var f=a(this),e=f.data("bootui.bootstrapTree");if(!e&&c=="destroy"){return}if(!e){var d=a.extend(true,{},a.fn.bootstrapTree.defaults,f.data(),((typeof c=="object"&&c)?c:{}));f.data("bootui.bootstrapTree",(e=new a.bootui.widget.BootstrapTree(this,d)))}if(typeof c=="string"){e[c].apply(e,[].concat(b||[]))}})};a.fn.bootstrapTree.defaults={version:"1.0.0",beforeRender:a.noop,errorRender:a.noop,afterRender:a.noop,height:"300px",url:"",postData:{},mtype:"POST",cache:false,collapsable:true,collapseSpeed:"fast",expandText:"\u5c55\u5f00\u8282\u70b9",expandIconClass:"icon-expand-alt",collapseText:"\u6298\u53e0\u8282\u70b9",collapseIconClass:"icon-collapse-alt",selectable:false,visibleLevel:1,data:[]}})(jQuery);
