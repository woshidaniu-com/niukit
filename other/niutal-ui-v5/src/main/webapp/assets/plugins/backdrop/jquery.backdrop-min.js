(function(a){a.bootui=a.bootui||{};a.bootui.widget=a.bootui.widget||{};a.bootui.widget.Backdrop=function(c,b){b.beforeRender.call(this,c);try{this.initialize.call(this,c,b)}catch(d){b.errorRender.call(this,d)}b.afterRender.call(this,c)};a.bootui.widget.Backdrop.prototype={constructor:a.bootui.widget.Backdrop,initialize:function(h,q){var k=this;this.$element=a(h);this.options=q;var n=a(h).closest("div.bootbox");var l=a(h).closest("div.modal-body");var d=l.size()>0?true:false;var b=d?l:a(h);var m=a(document.body).find(".widget-backdrop").size();var f='<div class="widget-backdrop in" style="display: none;"></div><div class="widget-backdrop-loading" style="display: none;"><div class="image header smaller lighter"><i class="icon-spinner icon-spin orange  bigger-160 "></i></div><div class="msg"></div></div>';var c,p,e,o;function j(){c=a(document.body).find(".widget-backdrop");p=a(document.body).find(".widget-backdrop-loading");e=a(p).find("div.image");o=a(p).find("div.msg")}function g(){j();if(c.size()==0){a(document.body).append(f);j()}if(q.html){a(o).html(q.html)}else{if(q.text){a(o).text(q.text)}else{if(q.href){a(o).load(q.href,q.args||{})}else{a(p).empty()}}}a.each([c,p],function(s,r){a(r).bind("contextmenu",function(){return false})})}function i(){var s=a(b).innerWidth();var z=a(b).innerHeight();var y=a(b).outerHeight();var v=a(b).offset();var u=a(window).height();var x=q["z-index"]||((n.size()>0)?a(n).css("z-index"):a(b).css("z-index"))||"1040";var r=parseInt(x=="auto"?"1040":x)+5;a.each([c,p],function(B,A){a(A).css({width:parseInt(s)+"px",height:parseInt(z)+"px",top:v.top,left:v.left})});a(c).css({"z-index":r});a(p).css({"z-index":r+1});if(q.className&&a.trim(q.className).length>0){a(e).find("i").removeClass(q.className).addClass(q.className)}var w=(parseInt(a(e).outerHeight())+parseInt(a(o).outerHeight()))/2;if((v.top+y)>u){a(e).css({"margin-top":(Math.round((u-v.top)/2)-w)+"px"});var t=false;a(window).scroll(function(B){if(!t){var A=Math.abs(a(this).scrollTop());t=true;window.setTimeout(function(){t=false;if(A<=v.top){a(e).css({"margin-top":Math.round(Math.min(y,(u-(v.top-A)))/2-w)+"px"})}else{a(e).css({"margin-top":(Math.round(Math.min(y,u)/2)-w+(A-v.top))+"px"})}},Math.abs(q.scrollDelay||50))}})}else{a(e).css({"margin-top":(parseInt(z)/2-w)+"px"})}}if(a.fn.resize){a(b).resize(function(r){g();i()})}a.extend(k,{setOptions:function(r){a.each(r||{},function(s,t){delete q[s]});a.extend(q,r||{})},show:function(r){k.setOptions(r||{});g();i();a(c).fadeIn(400);a(p).show()},hide:function(r){k.setOptions(r||{});a(c).fadeOut().remove();a(p).fadeOut(400).remove()}});g()},destroy:function(){this.$element.off(".backdrop.widget").removeData("widget.backdrop")},setDefaults:function(b){a.extend(a.fn.backdrop.defaults,b)}};a.fn.backdrop=function(c){var b=a.grep(arguments||[],function(e,d){return d>=1});return this.each(function(){var f=a(this),e=f.data("widget.backdrop");if(!e&&c=="destroy"){return}if(!e){var d=a.extend(true,{},a.fn.backdrop.defaults,f.data(),((typeof c=="object"&&c)?c:{}));f.data("widget.backdrop",(e=new a.bootui.widget.Backdrop(this,d)))}if(typeof c=="string"){e[c].apply(e,[].concat(b||[]))}})};a.fn.backdrop.defaults={version:"1.0.0",beforeRender:a.noop,errorRender:a.noop,afterRender:a.noop,"z-index":null,scrollDelay:50,className:"",img:'<img src="images/ico-loading.gif" width="32" height="32" align="middle" />',text:"\u52a0\u8f7d\u4e2d...",html:null,href:null,args:{},events:{}};a.fn.backdrop.Constructor=a.bootui.widget.Backdrop;a(document).on("click.widget.data-api",'[data-toggle*="backdrop"]',function(c){if(c.currentTarget=this){var b=a(this).data("target");a(b).backdrop({});a(b).backdrop("show")}})}(jQuery));
