(function(A){A.filehandle=function(G,E){var D=this;if(G){E=A.extend(true,{},A.filehandle.defaults,((typeof E=="object"&&E)?E:{}));if(G){var C=0;var F=0;var H=true;var B=A.filehandle.messages;A.each(G||[],function(I,J){if(A.fileMatch(E.fileType,J.name,J.type)){F+=(J.fileSize||J.size);C+=1}else{H=false;E.handleInvalidType.call(D,J,A.filehandle.format(B["needFileType"],E.fileType));return false}});if(H){if(C>E.maxCount){E.handleOverMaxCount.call(D,A.filehandle.format(B["overMaxCount"],E.maxCount));return false}if(F>A.capacity(E.maxTotal)){E.handleOverTotal.call(D,A.filehandle.format(B["overMaxTotal"],E.maxTotal));return false}A.each(G||[],function(I,J){if((J.fileSize||J.size)>A.capacity(E.maxSize)){return E.handleOverSize.call(D,J,A.filehandle.format(B["overMaxSize"],E.maxSize));return false}else{E.handleFile.call(D,J,A.filehandle.format(B["successTip"],[C,A.capacity(F,"KB")]),{"selectedCount":C,"total":F})}})}}}};A.filehandle.format=function(B,C){if(arguments.length==1){return function(){var D=A.makeArray(arguments);D.unshift(B);return B.apply(this,D)}}if(arguments.length>2&&C.constructor!=Array){C=A.makeArray(arguments).slice(1)}if(C.constructor!=Array){C=[C]}A.each(C,function(D,E){B=B.replace(new RegExp("\\{"+D+"\\}","g"),E)});return B};A.filehandle.defaults={fileType:"*.*",maxSize:"10M",maxTotal:"100MB",maxCount:30,handleInvalidType:function(C,B){},handleOverMaxCount:function(B){},handleOverTotal:function(B){},handleOverSize:function(C,B){},handleFile:function(D,B,C){}}}(jQuery));