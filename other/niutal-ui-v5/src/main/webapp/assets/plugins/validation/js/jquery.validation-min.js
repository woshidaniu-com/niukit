var afterSuccessFunc=function(b,c){var a=false;if($.type(b)==="string"){if(b.indexOf("\u6210\u529f")>-1){$.success(b,function(){a=true})}else{if(b.indexOf("\u5931\u8d25")>-1){$.error(b,function(){})}else{$.alert(b,function(){})}}}else{if($.isPlainObject(b)){if(b.status=="success"){$.success(b.message,function(){a=true})}else{if(b.status=="error"){$.error(b.message)}else{$.alert(b.message)}}}}return a};function submitForm(a,b){if(jQuery.isFunction(b)){afterSuccessFunc=b}jQuery("#"+a).submit()}(function(b){b.validator.auto=true;b.validator.selector="#ajaxForm";b.validator.setDefaults({debug:true});b.extend(b.validator.prototype,{focusInvalid:function(){if(this.settings.focusInvalid){try{var c=b(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]);if(c.hasClass("chosen-select")){c.css({display:"block"})}c.filter(":visible").focus().trigger("focusin");if(c.hasClass("chosen-select")){window.setTimeout(function(){c.css({display:"none"})},100)}}catch(d){}}}});if(b.metadata){b.metadata.setType("attr","validate")}var a=["progress-bar-info","progress-bar-success","progress-bar-warning","progress-bar-danger"];b.bootui=b.bootui||{};b.bootui.widget=b.bootui.widget||{};b.bootui.widget.Validator=function(d,c){c.beforeRender.call(this,d);try{this.initialize.call(this,d,c)}catch(f){c.errorRender.call(this,f)}c.afterRender.call(this,d)};b.bootui.widget.Validator.prototype={constructor:b.bootui.widget.Validator,initialize:function(g,d){var h=this;if(b(g).is("form")&&b(g).attr("action").length!=0){d.url=b(g).attr("action");d.type=b(g).attr("method")||"post"}var f=b.extend({},d,{onfocusout:function(i){var j=this;if(d.onblur){if(b.trim(b(i).attr("onfocus")).length==0){var j=this;window.setTimeout(function(){if(!j.checkable(i)&&(i.name in j.submitted||!j.optional(i))){j.element(i)}},100)}else{if(!j.checkable(i)&&(i.name in j.submitted||!j.optional(i))){j.element(i)}}}},success:function(j,k){b(j).remove();var i=b(k).getTargetElement();b(i).removeClass(d.errorParentClass);b(i).removeClass(d.warningParentClass);b(i).removeClass(d.validParentClass);if("wrap"==d.tipMethod){}else{if("tooltips"==d.tipMethod){b(k).getRealElement().tooltips("destroy")}}b(k).trigger("valid:success")},errorPlacement:function(m,i){var r=b(i).getTargetElement();b(r).removeClass(d.errorParentClass);b(r).removeClass(d.warningParentClass);b(r).removeClass(d.validParentClass);b(r).addClass(d.errorParentClass);if("wrap"==d.tipMethod){b(m).attr("class",d.errorClass);if(b(i).is(":radio")||b(i).is(":checkbox")){b(i).parent().find("em").remove();b(m).appendTo(b(i).parent())}else{b(i).find("em").remove();b(m).appendTo(b(i).parent());m.insertAfter(i)}}else{if("tooltips"==d.tipMethod){var p=b(i).closest(".modal-body");var k=b(i).closest(".ui-jqgrid");var l,o;var n=b(i).offset().top;if(p.size()>0){o=p.offset().top;if(n-o<50){l="bottom"}else{l="top"}}else{l="top"}var q={delay:0,html:true,placement:b(i).data("placement")||l,align:b(i).data("align")||"right",trigger:"hover focus",container:(k.size()>0?k:(p.size()>0?p:"body"))};if(b(this).is(":radio")||b(this).is(":checkbox")){q.placement="right"}var j=b(i).getRealElement();if(b(j).is(":visible")){b(j).tooltips("destroy");b(j).attr({title:b(m).html()});b(j).tooltips(q);if(d.tipAtOnce&&true==d.tipAtOnce){b(j).tooltips("show")}}}}},submitHandler:function(k){var j=d.beforeValidated.call(k);if(j){var i=b(d.progressElement);var n=b(i).size()==1&&!b.founded(d.progressURL);var m=b(i).size()==1&&b.founded(d.progressURL);var l={target:f.target,clearForm:f.clearForm,resetForm:f.resetForm,type:f.type||"post",url:f.url,contentType:"application/x-www-form-urlencoded;charset=UTF-8",dataType:f.dataType||"json",timeout:f.timeout,async:f.async,beforeSubmit:function(r,p,q){var o=f.beforeSubmit.call(k,r,p,q);if(o==true){if(n||m){i.removeClass(a.join(" ")).addClass("progress-bar-info");i.closest(".progress").show();i.removeData("successed");i.removeData("errored");i.removeData("finished")}if(n==true){i.closest(".progress").fadeIn("fast",function(){i.css("width","40%").text("40%").attr("aria-valuenow",40)})}}return o},beforeSend:function(p,o){if(n==true){i.css("width","70%").text("70%").attr("aria-valuenow",70)}else{if(m==true){i.closest(".progress").fadeIn("fast",function(){b(i).css("width","0%").text("0%").attr("aria-valuenow",0);var q=0;b(d.progressElement).progress(b.extend({},d,{beforeLookup:function(r,s){if(r==-1&&q<=10){q+=1;return true}return r>=0&&s!=true}}))})}}return f.beforeSend.call(this,p,o,d)},success:function(o,p,q){if(n==true){i.css("width","90%").text("90%").attr("aria-valuenow",90).removeClass(a.join(" ")).addClass("progress-bar-success")}else{if(m==true){if(b.type(o)==="string"){if(o.indexOf("\u6210\u529f")>-1){i.data("successed",true)}else{if(o.indexOf("\u5931\u8d25")>-1){i.data("errored",true)}}}else{if(b.isPlainObject(o)){if(o.status=="success"){i.data("successed",true)}else{if(o.status=="error"){i.data("errored",true)}}}}}}f.afterSuccess.call(k,o,p,d)},error:function(q,p,o){if(n==true){i.removeClass(a.join(" ")).addClass("progress-bar-danger")}else{if(m==true){i.data("errored",true)}}f.onError.call(this,q,p,o,d)},complete:function(p,o){if(o=="success"&&n==true){i.css("width","100%").text("100%").attr("aria-valuenow",100);window.setTimeout(function(){i.closest(".progress").hide();i.css("width","0%").text("0%").attr("aria-valuenow",0).removeClass(a.join(" "))},d.progressDelay)}i.data("finished",true);f.onComplete.call(this,p,o,d)}};if(b(k).is("form")&&b(k).attr("action").length!=0){l.url=b(k).attr("action");l.type=b(k).attr("method")||"post";l.contentType=b(k).attr("enctype")||l.contentType}window.setTimeout(function(){b(k).ajaxSubmit(l)},10)}return false}});var e=b(g).validate(f);var c={resetValid:function(){e.resetForm()},clearValid:function(){b(g).find(d.errorElement+"."+d.errorClass).remove();b(g).find(d.errorElement+"."+d.validClass).remove();b(g).find("."+d.errorParentClass).removeClass(d.errorParentClass);b(g).find("."+d.warningParentClass).removeClass(d.warningParentClass);b(g).find("."+d.validParentClass).removeClass(d.validParentClass);if(b.fn.tooltips){b(g).find(":input").each(function(){b(this).getRealElement().tooltips("destroy")})}}};b.extend(true,h,{isValid:function(){var i=true;b(g).find(":input").each(function(){if(b(this).valid()==false){i=false;return false}});return i},getRules:function(){return e.rules()},submitForm:function(){b(g).submit()},resetForm:function(){b(g).resetForm()},clearForm:function(){b(g).clearForm()}},c);b.each(c,function(i,j){b(g).bind(i,j)})},setDefaults:function(c){b.extend(b.fn.validateForm.defaults,c)},getDefaults:function(c){return b.fn.validateForm.defaults}};b.fn.validateForm=function(d){if(typeof d=="string"){var f=b(this[0]),e=f.data("myValidator");if(!e&&d=="destroy"){return}if(e){var c=b.grep(arguments||[],function(h,g){return g>=1});return e[d].apply(e,[].concat(c||[]))}}else{return this.each(function(){var i=b(this),h=i.data("myValidator");if(!h){var g=b.extend(true,{},b.fn.validateForm.defaults,i.data(),((typeof d=="object"&&d)?d:{}));i.data("myValidator",(h=new b.bootui.widget.Validator(this,g)))}})}};b.fn.validateForm.defaults={beforeRender:b.noop,errorRender:b.noop,afterRender:b.noop,onsubmit:true,onkeyup:false,onblur:true,onclick:false,focusInvalid:true,tipAtOnce:false,ignore:".ignore",errorElement:"em",errorClass:"error",errorParentClass:"has-error",warningClass:"warning",warningParentClass:"has-warning",validClass:"success",validParentClass:"has-success",progressElement:null,progressURL:null,progressDelay:3000,progressPeriod:400,progressComplete:b.noop,tipMethod:"tooltips",target:"#output",clearForm:false,resetForm:false,url:null,type:"post",dataType:"json",timeout:60000,async:true,beforeValidated:function(){return true},beforeSubmit:function(e,d,c){return true},beforeSend:function(e,c,d){return true},afterSuccess:function(d,e,c){if(typeof afterSuccessFunc=="function"){afterSuccessFunc.call(this,d,e)}},onError:function(f,e,d,c){},onComplete:function(e,d,c){}};b.fn.validateForm.Constructor=b.bootui.widget.Validator;b(document).on("validation.data-api",'[data-toggle*="validation"]',function(d){if(d.currentTarget=this){var c=b(this).validateForm({beforeValidated:function(){return true},beforeSubmit:function(g,f,e){return true},afterSuccess:function(e,f){afterSuccessFunc.call(c,e,f)}})}});b.fn.extend({isValid:function(){if(b(this).size()==0){return false}if(b(this[0]).is("form")){var c=true;b(this[0]).find(":input").each(function(){if(b(this).valid()==false){c=false;return false}});return c}else{return b(this).valid()!=false}},resetValid:function(){if(b(this[0]).is("form")){b(this[0]).validate().resetForm()}else{b(this[0].form).validate().resetForm()}},clearValid:function(){if(b(this[0]).is("form")){b(this).find("em.error").remove();b(this).find("em.success").remove();b(this).find(".has-error").removeClass("has-error");b(this).find(".has-warning").removeClass("has-warning");b(this).find(".has-success").removeClass("has-success");if(b.fn.tooltips){b(this).find(":input").each(function(){b(this).getRealElement().tooltips("destroy")})}}else{b(b(this).getTargetElement()).removeClass("has-error has-warning has-success");if(b.fn.tooltips){b(this).getRealElement().tooltips("destroy")}}}})}(jQuery));
