(function(a){var f=function(e,c){this.options=c;this.$el=a(e);0==a(".area-selection").size()&&a("body").append('\x3cdiv class\x3d"area-selection"\x3e\x3cbutton type\x3d"button" class\x3d"close"\x3e\x3cspan aria-hidden\x3d"true"\x3e\x26times;\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eClose\x3c/span\x3e\x3c/button\x3e\x3cdiv class\x3d"area-selection-box"\x3e\x3cul class\x3d"nav nav-tabs" role\x3d"tablist"\x3e\x3cli role\x3d"presentation" class\x3d"active"\x3e\x3ca href\x3d"#province" role\x3d"tab"\x3e\u7701\u4efd\x3c/a\x3e\x3c/li\x3e\x3cli role\x3d"presentation" class\x3d"hide"\x3e\x3ca href\x3d"#city" role\x3d"tab"\x3e\u57ce\u5e02\x3c/a\x3e\x3c/li\x3e\x3cli role\x3d"presentation" class\x3d"hide"\x3e\x3ca href\x3d"#county" role\x3d"tab"\x3e\u53bf\u533a \x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"tab-content"\x3e\x3cdiv role\x3d"tabpanel" class\x3d"tab-pane fade in active" id\x3d"province"\x3e\x3cul class\x3d"tag-list" data-type\x3d"province"\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv role\x3d"tabpanel" class\x3d"tab-pane fade" id\x3d"city"\x3e\x3cul class\x3d"tag-list" data-type\x3d"city"\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv role\x3d"tabpanel" class\x3d"tab-pane fade" id\x3d"county"\x3e\x3cul class\x3d"tag-list" data-type\x3d"county"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');this.init(c)};f.DEFAULTS={splitChar:"",level:"3",dataURL:_path+"/xtgl/xzqh/getAreaSelectionData.zf",jsonData:{parent:[],childrens:{}},getSelectData:function(e){return a(e).data("data-area")}};var k=function(e,c,d,b){var l=a('\x3cli\x3e\x3ca href\x3d"" role\x3d"tab" data-toggle\x3d"tab" class\x3d"transition-common"\x3e\x3c/a\x3e\x3c/li\x3e');b=b.empty();for(var g=0,m=c.length;g<m;g++){var h=l.clone();h.find("a").attr("href","#"+d).text(c[g].mc);h.find("a").attr("data-dm",c[g].dm);b.append(h)}b.find("li\x3ea").off().click(function(b){b.preventDefault();a(".area-selection .area-selection-box .nav\x3eli\x3ea").removeAttr("data-toggle");a(".area-selection .area-selection-box .nav\x3eli\x3ea\x3e.badge").remove();a(this).parent("li").removeClass("active");a(this).closest(".tag-list").find("li\x3ea").removeClass("cur");a(this).addClass("cur");var c="";b=a(this).attr("data-dm");var d=f.DEFAULTS.jsonData.childrens;if("province"==a(this).closest(".tag-list").data("type")&&void 0!=d[b]&&1<Number(f.DEFAULTS.level))k(e,d[b],"county",a('.area-selection .area-selection-box .tag-list[data-type\x3d"city"]'));else if("city"==a(this).closest(".tag-list").data("type")&&void 0!=d[b]&&2<Number(f.DEFAULTS.level))k(e,d[b],"county",a('.area-selection .area-selection-box .tag-list[data-type\x3d"county"]'));else{var g=a(this).closest(".tab-content").find(".tag-list\x3eli\x3ea.cur");g.each(function(b,e){c+=a(this).text();g.length>b+1&&(c+=f.DEFAULTS.splitChar)});e.val(c);e.data("data-area",a(this).attr("data-dm"));a(".area-selection").hide().css({top:0,left:0})}b=a(".area-selection .area-selection-box .nav\x3eli");0<b.find('a[href\x3d"'+a(this).attr("href")+'"]').length&&(b.removeClass("active"),b.find('a[href\x3d"'+a(this).attr("href")+'"]').parent("li").addClass("active"));b.find('a[href\x3d"#'+a(this).closest(".tag-list").data("type")+'"]').closest("li").prevAll("li").find("a").attr("data-toggle","tab");b.find('a[href\x3d"#'+a(this).closest(".tag-list").data("type")+'"]').attr("data-toggle","tab")})};f.prototype.init=function(e){var c=this.$el;c.css({cursor:"pointer"});c.after('\x3cspan class\x3d"glyphicon glyphicon-remove input-group-input-remove"\x3e\x3c/span\x3e');c.focus(function(){var b=a(this);a(".area-selection .area-selection-box .nav\x3eli\x3ea").removeAttr("data-toggle").click(function(a){a.preventDefault()});a(".area-selection .area-selection-box .nav\x3eli\x3ea\x3e.badge").remove();a(".area-selection .close").off().click(function(){a(".area-selection").hide().css({top:0,left:0})});a(".area-selection .area-selection-box .tag-list").empty();k(c,e.jsonData.parent,"city",a('.area-selection .area-selection-box .tag-list[data-type\x3d"province"]'));a(".area-selection .area-selection-box .nav\x3eli").removeClass("active");a(".area-selection .area-selection-box .nav\x3eli:first").addClass("active");a(".area-selection .area-selection-box .tab-pane").removeClass("active").removeClass("in");a(".area-selection .area-selection-box .tab-pane:first").addClass("active").addClass("in");1<Number(f.DEFAULTS.level)&&a(".area-selection .area-selection-box .nav\x3eli:eq(1)").removeClass("hide");2<Number(f.DEFAULTS.level)&&a(".area-selection .area-selection-box .nav\x3eli:eq(2)").removeClass("hide");var d=b.outerHeight(),g=b.outerWidth();a(".area-selection").offset(b.offset());a(".area-selection").css({top:function(){return parseFloat(a(this).css("top"))+d},width:g}).slideDown(200)});a(".area-selection").on("mouseleave",function(){a(".area-selection").hide().css({top:0,left:0});c.blur()});var d;a(".input-group-input\x3e.form-control").on("keyup focus",function(){clearTimeout(d);var b=a(this);""!=b.val()&&(b.siblings(".input-group-input-remove").show(),b.siblings(".input-group-input-remove").click(function(){b.val("");b.data("data-area","")}))}).blur(function(){var b=a(this);d=setTimeout(function(){b.siblings(".input-group-input-remove").off("click");b.siblings(".input-group-input-remove").hide()},150)})};a.fn.areaSelection=function(e){var c;"string"===typeof e&&(c=a.fn.areaSelection.defaults[e].apply(this,this));var d=a.extend(f.DEFAULTS,e);""!=d.dataURL&&0==a(".area-selection").size()&&a.getJSON(d.dataURL,{},function(b){a.extend(d,{jsonData:{parent:b.parent,childrens:b.childrens}})});return c||new f(this,d)};a.fn.areaSelection.Constructor=f;a.fn.areaSelection.defaults=f.DEFAULTS})(jQuery);