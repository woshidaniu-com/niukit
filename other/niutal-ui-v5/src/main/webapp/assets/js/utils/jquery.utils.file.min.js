(function(b){var k=/^([1-9]\d*|[1-9]\d*.\d*|0.\d*[1-9]\d*)(B|KB|MB|GB|TB|PB|EB|ZB|YB|BB)$/,h={B:1,KB:1024,MB:1048576,GB:1073741824,TB:1099511627776};b.capacity=function(a,d){if(!b.founded(a))return 0;a=b.trim(a.toString());if(!b.founded(d)){a=a.toUpperCase();var c=k.exec(a);return c&&c[2]?parseFloat(c[1])*(h[c[2]]||1):a}if(b.isNumeric(a)){a=parseFloat(a);if(1024>a)return a+"B";c=h[d.toUpperCase()];return(Math.round(100*a/c)/100).toString()+d.toUpperCase()}return 0};b.fileMatch=function(a,d,c){var f=c&&0<b.trim(c).length?b.trim(c):"",e=f.split("/"),f=e[e.length-1].toLowerCase();if("regexp"===b.type(a))return a.test(d)||a.test(f)?!0:!1;if(!b.isArray(a))return b.fileMatch(b.makeArray(a),d,c);var g=!1;b.each(a,function(a,e){if("regexp"===b.type(e))g=b.fileMatch(e,d,c);else if("string"===b.type(e)&&0<b.trim(e).length){var h=e.split(";");b.each(h,function(a,c){c=b.trim(c||"");if(0<c.length&&-1<c.indexOf("."))if("*.*"==c)g=!0;else{0!=c.indexOf(".")&&(c=c.replace(".","\\."));var e="";0==c.indexOf("*")&&(c=c.substring(1),0!=c.indexOf(".")&&(e+="."));c.lastIndexOf("*")==c.length-1&&(c=c.substring(0,c.length-1));e=new RegExp(e+(c+"$"),"g");if(e.test(d)||e.test(f))g=!0}if(g)return!1})}if(g)return!1});return g};b.fn.extend({elementBlur:function(){if("IFRAME"==self.frameElement.tagName){var a=self.document.getElementById("focusDiv");a||(b('\x3cdiv id\x3d"focusDiv" style\x3d"width: 1px; height: 1px;"\x3e\x3c/div\x3e').appendTo(self.document.body),a=self.document.getElementById("focusDiv"));b(a).focus()}else this.blur()},getFiles:function(){if(b(this[0]).is(":file")){var a=this[0].files;a||(a=function(){if(!0===b.browser.msie){try{var a=new ActiveXObject("Scripting.FileSystemObject"),c=null;6>=b.browser.version?c=a.GetFile(this.value):7<=b.browser.version&&(this.select(),b(this).elementBlur(),c=a.GetFile(document.selection.createRange().text))}catch(f){alert("\u8bf7\u4fee\u6539IE\u6d4f\u89c8\u5668ActiveX\u5b89\u5168\u8bbe\u7f6e\u4e3a\u542f\u7528~\uff01")}return[c]}}.call(this[0]));return a}return[]},getFileCount:function(){return b(this).getFiles().length},getFileSize:function(){if(b(this[0]).is(":file")){var a=b(this).getFiles();if(0<a.length){if(1<a.length){var d=[];b.each(this.files||[],function(c,b){try{d.push(a.item(c).fileSize)}catch(e){d.push(b.size)}});return d.join(";")}try{return a.item(0).fileSize}catch(c){return a[0].size}}}return 0},getFileName:function(a){if(b(this[0]).is(":file")){var d=b(this).getFiles();if(0<d.length){if(1<d.length){var c=[];b.each(this.files||[],function(a,b){try{c.push(d.item(a).fileName)}catch(g){c.push(b.name)}});return c.join(";")}try{return d.item(0).fileName}catch(f){return d[0].name}}}return 0},getFileFullPath:function(){var a="";if(b(this[0]).is(":file")){var d=this[0].files;if(d){for(var c=[],f=0;f<d.length;f++){try{a=d.item(f).getAsDataURL()}catch(e){a=window.URL.createObjectURL(d[f])}c.push(a)}a=c.join(";")}else b.browser.msie?6>=b.browser.version?a=this[0].value:7<=b.browser.version&&(this.select(),b(this).elementBlur(),a=document.selection.createRange().text):a=this[0].value}return a},getFilePath:function(){var a="";if(b(this[0]).is(":file")){var d=b(this).getFiles(),c=[];b.each(d||[],function(b,e){try{a=e.path||d.item(b).getAsDataURL()}catch(g){a=window.URL.createObjectURL(e)}c.push(a)});a=c.join(";")}return a},getFileSuffix:function(){var a=b(this).getFilePath();if(b.founded(a)){var a=a.split(";"),d=[];b.each(a||[],function(a,b){d.push(b.substr(b.lastIndexOf(".")).toLowerCase())});return d.join(";")}return null},isSuffix:function(a){if(b(this[0]).is(":file")){var d=b(this).getFileSuffix();if(b.founded(d)&&b.founded(a)){var d=d.split(";"),c=!1;b.each(d||[],function(d,e){return c=b.fileMatch(a,e,e)});return c}}return!1},clearFile:function(){var a=b(this[0]);if(b(a).is(":file")){var d=b(a).clone(!0,!0).val("");try{this.select(),document.execCommand("delete")}catch(c){a.after(d),a.remove()}}},getAsBinary:function(a){if(b(this[0]).is(":file"))try{return this[0].files.item(a||0).getAsBinary()}catch(c){if("undefined"!=typeof FileReader){var d=new FileReader;d.readAsBinaryString(this[0].files[a||0]);d.onload=function(a){}}}return null},getAsDataURL:function(a){if(b(this[0]).is(":file"))try{return this[0].files.item(a||0).getAsDataURL()}catch(c){if("undefined"!=typeof FileReader){var d=new FileReader;d.readAsDataURL(this[0].files[a||0]);d.onload=function(a){}}}return null},getAsText:function(a,d){if(b(this[0]).is(":file"))try{return this[0].files.item(a||0).getAsText(d||"utf-8")}catch(f){if("undefined"!=typeof FileReader){var c=new FileReader;c.readAsDataURL(this[0].files[a||0],d||"utf-8");c.onload=function(a){}}}return null}})})(jQuery);