(function(b){var c={media:"all",charset:"utf-8",ignore:true,cache:true,cacheURL:true,async:false,progress:b.noop,complete:b.noop};b.extend(Array.prototype,{contains:function(f,h){var g=false,h=h||0;for(var e=h;e<this.length;e++){if(f==this[e]){g=true;break}}return g}});b.extend({matchURL:function(e){var f=b.trim(e||"").toLowerCase();return typeof e=="string"&&f.length>0&&/(?:\S+\.(?:js|css|properties)(?:\?ver=\S+)?)/.test(f)},matchJS:function(e){var f=b.trim(e||"").toLowerCase();return typeof e=="string"&&f.length>0&&/(?:\S+\.js(?:\?ver=\S+)?)/.test(f)},matchCss:function(e){var f=b.trim(e||"").toLowerCase();return typeof e=="string"&&f.length>0&&/(?:\S+\.css(?:\?ver=\S+)?)/.test(f)}});function a(e,f){if(e.attachEvent){e.attachEvent("onload",f)}else{setTimeout(function(){d(e,f)},0)}}function d(g,h){if(h.isCalled){return}var e=false;if(/webkit/i.test(navigator.userAgent)){if(g.sheet){e=true}}else{if(g.sheet){try{if(g.sheet.cssRules){e=true}}catch(f){if(f.code===1000){e=true}}}}if(e){setTimeout(function(){h()},1)}else{setTimeout(function(){d(g,h)},1)}}b.fn.include=function(e,f){var g=b(this[0]);var h=b.data(g,"cacheURL")||[];return b.when(b.Deferred(function(m){if(b.matchURL(e)){if(h.contains(e)){m.resolve()}else{try{var j=b.extend(true,{},c,b(g).data(),((typeof f=="object"&&f)?f:{}),{dataType:"text",url:e});var k=function(o){do{o+=~~(Math.random()*1000000)}while(document.getElementById(o));return o};b.ajaxSetup({async:j.async,cache:j.cache});if(b.matchJS(e)){var i=document.createElement("script");i.language="javascript";i.type="text/javascript";i.id=k("script");b.ajax(b.extend(true,j,{success:function(p){try{i.appendChild(document.createTextNode(p))}catch(o){i.text=p}m.resolve()},error:function(){document.removeChild(i);if(j.ignore&&j.ignore!=true){m.reject()}}}));g[0].appendChild(i)}else{if(b.matchCss(e)){var l=document.createElement("style");l.id=k("css");l.media=j.media||"all";b.ajax(b.extend(true,j,{success:function(o){if(l.styleSheet){l.styleSheet.cssText=o}else{l.appendChild(document.createTextNode(o))}m.resolve()},error:function(){document.removeChild(l);if(j.ignore&&j.ignore!=true){m.reject()}}}));g[0].appendChild(l)}}b.ajaxSetup({async:true,cache:true});if(j.cacheURL==true){h.push(e);b.data(g,"cacheURL",h)}}catch(n){m.reject();throw new Error(n)}}}else{m.resolve()}}).promise())};b.fn.includes=function(h,e){var g=b(this);h=b.grep(b.makeArray(h||[]),function(j,k){return b.matchURL(j)},false);function f(l,k,j){return b.when(b.Deferred(function(i){k[j].call(g,i,h[j])}).promise()).always(function(){if(j<k.length){f(l,k,j+1)}else{l.resolve()}})}return b.when(b.Deferred(function(l){try{var k=[];for(var j=0;j<h.length;j++){k[j]=function(i,n){console.log("url:"+n);b(g).include(n,e).fail(function(){if(e.ignore&&e.ignore!=true){i.reject()}}).always(function(){i.resolve()})}}f(l,k,0)}catch(m){l.reject()}}).promise())};b.fn.loadResource=function(e,f){var g=b(this[0]);var h=b.data(g,"cacheURL")||[];return b.when(b.Deferred(function(j){if(b.matchURL(e)){if(h.contains(e)){j.resolve()}else{try{var s=b.extend(true,{},c,b(g).data(),((typeof f=="object"&&f)?f:{}));var p=function(t){do{t+=~~(Math.random()*1000000)}while(document.getElementById(t));return t};if(b.matchJS(e)){if(s.async==false){b.ajaxSetup({async:s.async,cache:s.cache});b.getScript(e).done(function(){if(b.isFunction(s.complete)){s.complete.call(this)}j.resolve();if(s.cacheURL==true){h.push(e);b.data(g,"cacheURL",h)}}).fail(function(){if(s.ignore&&s.ignore!=true){j.reject()}});b.ajaxSetup({async:true,cache:true})}else{var r=document.createElement("script");r.setAttribute("id",p("script"));r.setAttribute("type","text/javascript");r.setAttribute("media",s.media||"all");r.setAttribute("charset",s.charset||"utf-8");r.setAttribute("src",e);if(s.async==true){r.setAttribute("async",true);r.setAttribute("defer",true)}else{r.setAttribute("async",false)}g[0].appendChild(r);var l=function(){r.onload=r.onreadystatechange=r.onerror=null;if(g[0]&&r.parentNode){g[0].removeChild(r);r=null}};var m=function(t){if((!this.readyState)||(/loaded|complete/.test(this.readyState))){if(b.isFunction(s.complete)){s.complete.call(this)}l();j.resolve();if(s.cacheURL==true){h.push(e);b.data(g,"cacheURL",h)}}};var n=function(){l();if(s.ignore&&s.ignore!=true){j.reject()}};var k=window.setInterval(function(){if(r){if((!r.readyState)||(/loaded|complete/.test(r.readyState))){window.clearInterval(k)}else{if(b.isFunction(s.progress)){s.progress.call(r)}}}else{window.clearInterval(k)}},100);var i=false;r.onload=r.onreadystatechange=function(){if(i){return}m.call(this);i=true};r.onerror=function(){n.call(this)}}}else{if(b.matchCss(e)){var q=window.document.createElement("link");q.setAttribute("id",p("css"));q.setAttribute("type","text/css");q.setAttribute("rel","stylesheet");q.setAttribute("media",s.media||"all");q.setAttribute("charset",s.charset||"utf-8");q.setAttribute("href",e);g[0].appendChild(q);a(q,function(){j.resolve();if(s.cacheURL==true){h.push(e);b.data(g,"cacheURL",h)}})}}}catch(o){j.reject();throw new Error(o)}}}else{j.resolve()}}).promise())};b.fn.loadResources=function(h,e){var g=b(this);h=b.grep(b.makeArray(h||[]),function(j,k){return typeof j=="string"&&b.trim(j).length>0&&/(?:\S+\.(?:js|css)(?:\?ver=\S+)?)/.test(b.trim(j).toLowerCase())},false);function f(k,l,j){return b.when(b.Deferred(function(i){if(typeof l[j]!="undefined"){l[j].call(g,i,h[j])}else{i.resolve()}}).promise()).always(function(){if(j<l.length){f(k,l,j+1)}else{k.resolve()}})}return b.when(b.Deferred(function(k){try{var m=[];for(var j=0;j<h.length;j++){m[j]=function(i,n){console.log("url:"+n);b(g).loadResource(n,e).fail(function(){if(e.ignore&&e.ignore!=true){i.reject()}}).always(function(){i.resolve()})}}f(k,m,0)}catch(l){k.reject()}}).promise())}}(jQuery));
